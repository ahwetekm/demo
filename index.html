<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liste Oluştur QR Kod Paylaş</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        .bg-primary {
            background-color: #4f46e5;
        }
        .text-primary {
            color: #4f46e5;
        }
        .border-primary {
            border-color: #4f46e5;
        }
        .hover-bg-primary:hover {
            background-color: #4338ca;
        }
        .transition-all {
            transition: all 0.3s ease;
        }
        .hidden {
            display: none;
        }
        .max-h-96 {
            max-height: 24rem;
        }
        /* Hover effects */
        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        .item-hover:hover {
            background-color: #f9fafb;
        }
        .button-hover:hover {
            transform: scale(1.02);
        }
        .button-hover:active {
            transform: scale(0.98);
        }
        /* Animation */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- Header -->
    <header class="bg-white shadow-md sticky top-0 z-10">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2 cursor-pointer" onclick="showPage('home')">
                <i class="fas fa-qrcode text-3xl text-primary"></i>
                <h1 class="text-2xl font-bold text-gray-800">QR Liste</h1>
            </div>
            <nav class="hidden md:flex space-x-6">
                <a href="#" class="text-gray-600 hover:text-primary transition-all" onclick="showPage('home')">Ana Sayfa</a>
                <a href="#" class="text-gray-600 hover:text-primary transition-all" onclick="showPage('guide')">Kullanım Kılavuzu</a>
                <a href="#" class="text-gray-600 hover:text-primary transition-all" onclick="showPage('contact')">İletişim</a>
                <a href="#" class="text-gray-600 hover:text-primary transition-all auth-hide" onclick="showPage('login')">Giriş Yap</a>
                <a href="#" class="text-gray-600 hover:text-primary transition-all auth-hide" onclick="showPage('register')">Kayıt Ol</a>
                <a href="#" class="text-gray-600 hover:text-primary transition-all auth-show hidden" onclick="showPage('dashboard')">Listelerim</a>
                <a href="#" class="text-gray-600 hover:text-primary transition-all auth-show hidden" onclick="logout()">Çıkış Yap</a>
            </nav>
            <button class="md:hidden text-gray-600 hover:text-primary transition-all" id="mobile-menu-button">
                <i class="fas fa-bars text-2xl"></i>
            </button>
        </div>
        <!-- Mobile Menu -->
        <div class="md:hidden hidden" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3 bg-white shadow-md">
                <a href="#" class="block px-3 py-2 text-gray-600 hover:text-primary transition-all" onclick="showPage('home')">Ana Sayfa</a>
                <a href="#" class="block px-3 py-2 text-gray-600 hover:text-primary transition-all" onclick="showPage('guide')">Kullanım Kılavuzu</a>
                <a href="#" class="block px-3 py-2 text-gray-600 hover:text-primary transition-all" onclick="showPage('contact')">İletişim</a>
                <a href="#" class="block px-3 py-2 text-gray-600 hover:text-primary transition-all auth-hide" onclick="showPage('login')">Giriş Yap</a>
                <a href="#" class="block px-3 py-2 text-gray-600 hover:text-primary transition-all auth-hide" onclick="showPage('register')">Kayıt Ol</a>
                <a href="#" class="block px-3 py-2 text-gray-600 hover:text-primary transition-all auth-show hidden" onclick="showPage('dashboard')">Listelerim</a>
                <a href="#" class="block px-3 py-2 text-gray-600 hover:text-primary transition-all auth-show hidden" onclick="logout()">Çıkış Yap</a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto p-4 mt-8">
        <!-- Home Page -->
        <div id="home" class="page">
            <div class="text-center mb-16 fade-in">
                <h2 class="text-4xl font-bold text-gray-800 mb-4">Liste Oluştur, QR Kod ile Paylaş</h2>
                <p class="text-xl text-gray-600 max-w-2xl mx-auto">
                    İhtiyaç listelerinizi kolayca oluşturun, QR kod ile paylaşın ve güncelleyin.
                </p>
                <div class="mt-10">
                    <button onclick="showPage('login')" class="bg-primary text-white px-8 py-3 rounded-lg shadow-lg hover-bg-primary transition-all button-hover auth-hide">
                        Hemen Başla
                    </button>
                    <button onclick="showPage('createList')" class="bg-primary text-white px-8 py-3 rounded-lg shadow-lg hover-bg-primary transition-all button-hover auth-show hidden">
                        Liste Oluştur
                    </button>
                </div>
            </div>
            
            <div class="grid md:grid-cols-3 gap-8 mt-12">
                <div class="bg-white p-6 rounded-xl shadow-md card-hover transition-all">
                    <div class="text-primary text-4xl mb-4">
                        <i class="fas fa-pencil-alt"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Kolay Liste Oluşturma</h3>
                    <p class="text-gray-600">
                        İhtiyaçlarınızı, miktarlarını ve görselleri ekleyerek detaylı listeler oluşturun.
                    </p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md card-hover transition-all">
                    <div class="text-primary text-4xl mb-4">
                        <i class="fas fa-qrcode"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">QR Kod Paylaşımı</h3>
                    <p class="text-gray-600">
                        Oluşturduğunuz listeleri QR kod aracılığıyla anında paylaşabilirsiniz.
                    </p>
                </div>
                <div class="bg-white p-6 rounded-xl shadow-md card-hover transition-all">
                    <div class="text-primary text-4xl mb-4">
                        <i class="fas fa-edit"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Kolay Düzenleme</h3>
                    <p class="text-gray-600">
                        QR kodu okutarak listenizi istediğiniz zaman düzenleyebilirsiniz.
                    </p>
                </div>
            </div>
        </div>

        <!-- Login Page -->
        <div id="login" class="page hidden">
            <div class="max-w-md mx-auto bg-white p-8 rounded-xl shadow-md fade-in">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Giriş Yap</h2>
                <div id="login-error" class="bg-red-100 text-red-600 p-3 rounded mb-4 hidden"></div>
                <form id="login-form">
                    <div class="mb-4">
                        <label for="login-email" class="block text-gray-700 mb-2">E-posta Adresi</label>
                        <input type="email" id="login-email" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" required>
                    </div>
                    <div class="mb-6">
                        <label for="login-password" class="block text-gray-700 mb-2">Şifre</label>
                        <input type="password" id="login-password" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" required>
                    </div>
                    <button type="submit" class="w-full bg-primary text-white py-2 rounded-lg hover-bg-primary transition-all button-hover">
                        Giriş Yap
                    </button>
                </form>
                <div class="mt-4 text-center">
                    <p class="text-gray-600">
                        Hesabınız yok mu? 
                        <a href="#" class="text-primary hover:underline" onclick="showPage('register')">Kayıt Ol</a>
                    </p>
                </div>
            </div>
        </div>

        <!-- Register Page -->
        <div id="register" class="page hidden">
            <div class="max-w-md mx-auto bg-white p-8 rounded-xl shadow-md fade-in">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Hesap Oluştur</h2>
                <div id="register-error" class="bg-red-100 text-red-600 p-3 rounded mb-4 hidden"></div>
                <form id="register-form">
                    <div class="mb-4">
                        <label for="register-name" class="block text-gray-700 mb-2">Ad Soyad</label>
                        <input type="text" id="register-name" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" required>
                    </div>
                    <div class="mb-4">
                        <label for="register-email" class="block text-gray-700 mb-2">E-posta Adresi</label>
                        <input type="email" id="register-email" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" required>
                    </div>
                    <div class="mb-6">
                        <label for="register-password" class="block text-gray-700 mb-2">Şifre</label>
                        <input type="password" id="register-password" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" required>
                    </div>
                    <button type="submit" class="w-full bg-primary text-white py-2 rounded-lg hover-bg-primary transition-all button-hover">
                        Kayıt Ol
                    </button>
                </form>
                <div class="mt-4 text-center">
                    <p class="text-gray-600">
                        Zaten hesabınız var mı? 
                        <a href="#" class="text-primary hover:underline" onclick="showPage('login')">Giriş Yap</a>
                    </p>
                </div>
            </div>
        </div>

        <!-- Dashboard Page -->
        <div id="dashboard" class="page hidden">
            <div class="mb-6 flex justify-between items-center fade-in">
                <h2 class="text-3xl font-bold text-gray-800">Listelerim</h2>
                <button onclick="showPage('createList')" class="bg-primary text-white px-4 py-2 rounded-lg shadow hover-bg-primary transition-all button-hover flex items-center">
                    <i class="fas fa-plus mr-2"></i> Yeni Liste Oluştur
                </button>
            </div>
            
            <div id="qr-list-counter" class="mb-4 text-gray-600"></div>
            
            <div id="user-lists" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Lists will be populated here -->
                <div class="text-center text-gray-500 col-span-full py-10" id="no-lists-message">
                    <i class="fas fa-clipboard-list text-5xl mb-4"></i>
                    <p class="text-xl">Henüz liste oluşturmadınız.</p>
                </div>
            </div>
        </div>

        <!-- Create List Page -->
        <div id="createList" class="page hidden">
            <div class="max-w-4xl mx-auto fade-in">
                <div class="mb-6">
                    <h2 class="text-3xl font-bold text-gray-800">Yeni Liste Oluştur</h2>
                    <p class="text-gray-600 mt-2">Liste adını belirleyin ve öğeler ekleyin.</p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <div class="mb-6">
                        <label for="list-name" class="block text-gray-700 mb-2 font-medium">Liste Adı</label>
                        <input type="text" id="list-name" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" placeholder="Alışveriş Listesi" required>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Yeni Öğe Ekle</h3>
                    
                    <div class="grid md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label for="item-name" class="block text-gray-700 mb-2">Öğe İsmi</label>
                            <input type="text" id="item-name" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" placeholder="Elma">
                        </div>
                        <div>
                            <label for="item-quantity" class="block text-gray-700 mb-2">Öğe Miktarı</label>
                            <input type="text" id="item-quantity" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" placeholder="2 kg">
                        </div>
                        <div>
                            <label for="item-image" class="block text-gray-700 mb-2">Resim (İsteğe Bağlı)</label>
                            <input type="file" id="item-image" accept="image/*" class="w-full px-4 py-1.5 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all">
                        </div>
                    </div>
                    
                    <button id="add-item" class="bg-primary text-white px-4 py-2 rounded-lg shadow hover-bg-primary transition-all button-hover">
                        <i class="fas fa-plus mr-2"></i> Öğe Ekle
                    </button>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Liste Öğeleri</h3>
                    
                    <div id="item-list" class="max-h-96 overflow-y-auto">
                        <div id="empty-list-message" class="text-center py-8 text-gray-500">
                            <i class="fas fa-clipboard text-4xl mb-3"></i>
                            <p>Henüz öğe eklemediniz.</p>
                        </div>
                        <!-- Items will be added here -->
                    </div>
                </div>
                
                <div class="flex justify-end">
                    <button id="save-list" class="bg-primary text-white px-6 py-3 rounded-lg shadow-lg hover-bg-primary transition-all button-hover">
                        <i class="fas fa-save mr-2"></i> Kaydet ve QR Kod Oluştur
                    </button>
                </div>
            </div>
        </div>

        <!-- View List Page -->
        <div id="viewList" class="page hidden">
            <div class="max-w-4xl mx-auto fade-in">
                <div class="mb-6 flex items-center">
                    <button onclick="showPage('dashboard')" class="text-gray-600 hover:text-primary mr-4 transition-all">
                        <i class="fas fa-arrow-left text-lg"></i>
                    </button>
                    <h2 class="text-3xl font-bold text-gray-800" id="view-list-name">Liste Detayları</h2>
                </div>
                
                <div class="grid md:grid-cols-3 gap-6">
                    <div class="md:col-span-2">
                        <div class="bg-white p-6 rounded-xl shadow-md mb-6 card-hover transition-all">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">Liste Öğeleri</h3>
                            
                            <div id="view-item-list" class="max-h-96 overflow-y-auto">
                                <!-- Items will be displayed here -->
                            </div>
                        </div>
                        
                        <div class="flex justify-end">
                            <button id="edit-list" class="bg-primary text-white px-6 py-3 rounded-lg shadow-lg hover-bg-primary transition-all button-hover">
                                <i class="fas fa-edit mr-2"></i> Listeyi Düzenle
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <div class="bg-white p-6 rounded-xl shadow-md card-hover transition-all">
                            <h3 class="text-xl font-bold text-gray-800 mb-4">QR Kod</h3>
                            <div id="qrcode-container" class="flex justify-center mb-4"></div>
                            <button id="download-qr" class="w-full bg-gray-200 text-gray-800 px-4 py-2 rounded-lg hover:bg-gray-300 transition-all button-hover flex items-center justify-center">
                                <i class="fas fa-download mr-2"></i> QR Kodu İndir
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Edit List Page -->
        <div id="editList" class="page hidden">
            <div class="max-w-4xl mx-auto fade-in">
                <div class="mb-6">
                    <h2 class="text-3xl font-bold text-gray-800">Listeyi Düzenle</h2>
                    <p class="text-gray-600 mt-2" id="edit-list-id"></p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <div class="mb-6">
                        <label for="edit-list-name" class="block text-gray-700 mb-2 font-medium">Liste Adı</label>
                        <input type="text" id="edit-list-name" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" required>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Yeni Öğe Ekle</h3>
                    
                    <div class="grid md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label for="edit-item-name" class="block text-gray-700 mb-2">Öğe İsmi</label>
                            <input type="text" id="edit-item-name" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" placeholder="Elma">
                        </div>
                        <div>
                            <label for="edit-item-quantity" class="block text-gray-700 mb-2">Öğe Miktarı</label>
                            <input type="text" id="edit-item-quantity" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" placeholder="2 kg">
                        </div>
                        <div>
                            <label for="edit-item-image" class="block text-gray-700 mb-2">Resim (İsteğe Bağlı)</label>
                            <input type="file" id="edit-item-image" accept="image/*" class="w-full px-4 py-1.5 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all">
                        </div>
                    </div>
                    
                    <button id="edit-add-item" class="bg-primary text-white px-4 py-2 rounded-lg shadow hover-bg-primary transition-all button-hover">
                        <i class="fas fa-plus mr-2"></i> Öğe Ekle
                    </button>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Liste Öğeleri</h3>
                    
                    <div id="edit-item-list" class="max-h-96 overflow-y-auto">
                        <!-- Items will be added here -->
                    </div>
                </div>
                
                <div class="flex justify-between">
                    <button onclick="cancelEdit()" class="bg-gray-200 text-gray-800 px-6 py-3 rounded-lg shadow-lg hover:bg-gray-300 transition-all button-hover">
                        <i class="fas fa-times mr-2"></i> İptal
                    </button>
                    <button id="update-list" class="bg-primary text-white px-6 py-3 rounded-lg shadow-lg hover-bg-primary transition-all button-hover">
                        <i class="fas fa-save mr-2"></i> Değişiklikleri Kaydet
                    </button>
                </div>
            </div>
        </div>

        <!-- View Public List Page -->
        <div id="publicList" class="page hidden">
            <div class="max-w-4xl mx-auto fade-in">
                <div class="mb-6">
                    <h2 class="text-3xl font-bold text-gray-800" id="public-list-name">Liste</h2>
                    <p class="text-gray-600 mt-2" id="public-list-id"></p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Liste Öğeleri</h3>
                    
                    <div id="public-item-list" class="max-h-96 overflow-y-auto">
                        <!-- Items will be displayed here -->
                    </div>
                </div>
                
                <div class="flex justify-end">
                    <button id="edit-public-list" class="bg-primary text-white px-6 py-3 rounded-lg shadow-lg hover-bg-primary transition-all button-hover">
                        <i class="fas fa-edit mr-2"></i> Listeyi Düzenle
                    </button>
                </div>
            </div>
        </div>

        <!-- Edit Public List Page -->
        <div id="editPublicList" class="page hidden">
            <div class="max-w-4xl mx-auto fade-in">
                <div class="mb-6">
                    <h2 class="text-3xl font-bold text-gray-800">Listeyi Düzenle</h2>
                    <p class="text-gray-600 mt-2" id="edit-public-list-id"></p>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <div class="mb-6">
                        <label for="edit-public-list-name" class="block text-gray-700 mb-2 font-medium">Liste Adı</label>
                        <input type="text" id="edit-public-list-name" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" required>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Yeni Öğe Ekle</h3>
                    
                    <div class="grid md:grid-cols-3 gap-4 mb-4">
                        <div>
                            <label for="edit-public-item-name" class="block text-gray-700 mb-2">Öğe İsmi</label>
                            <input type="text" id="edit-public-item-name" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" placeholder="Elma">
                        </div>
                        <div>
                            <label for="edit-public-item-quantity" class="block text-gray-700 mb-2">Öğe Miktarı</label>
                            <input type="text" id="edit-public-item-quantity" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" placeholder="2 kg">
                        </div>
                        <div>
                            <label for="edit-public-item-image" class="block text-gray-700 mb-2">Resim (İsteğe Bağlı)</label>
                            <input type="file" id="edit-public-item-image" accept="image/*" class="w-full px-4 py-1.5 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all">
                        </div>
                    </div>
                    
                    <button id="edit-public-add-item" class="bg-primary text-white px-4 py-2 rounded-lg shadow hover-bg-primary transition-all button-hover">
                        <i class="fas fa-plus mr-2"></i> Öğe Ekle
                    </button>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Liste Öğeleri</h3>
                    
                    <div id="edit-public-item-list" class="max-h-96 overflow-y-auto">
                        <!-- Items will be added here -->
                    </div>
                </div>
                
                <div class="flex justify-between">
                    <button onclick="cancelPublicEdit()" class="bg-gray-200 text-gray-800 px-6 py-3 rounded-lg shadow-lg hover:bg-gray-300 transition-all button-hover">
                        <i class="fas fa-times mr-2"></i> İptal
                    </button>
                    <button id="update-public-list" class="bg-primary text-white px-6 py-3 rounded-lg shadow-lg hover-bg-primary transition-all button-hover">
                        <i class="fas fa-save mr-2"></i> Değişiklikleri Kaydet
                    </button>
                </div>
            </div>
        </div>

        <!-- QR Scanner Page -->
        <div id="qrScanner" class="page hidden">
            <div class="max-w-md mx-auto bg-white p-8 rounded-xl shadow-md fade-in">
                <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">QR Kod Tara</h2>
                <div class="text-center mb-4">
                    <input type="text" id="list-id-input" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" placeholder="Liste ID girin">
                </div>
                <button id="scan-qr-button" class="w-full bg-primary text-white py-2 rounded-lg hover-bg-primary transition-all button-hover mb-4">
                    <i class="fas fa-qrcode mr-2"></i> QR Kod Tara
                </button>
                <div id="qr-scanner-container" class="hidden mb-4">
                    <video id="qr-video" class="w-full rounded-lg"></video>
                </div>
                <button id="view-list-button" class="w-full bg-primary text-white py-2 rounded-lg hover-bg-primary transition-all button-hover">
                    <i class="fas fa-eye mr-2"></i> Listeyi Görüntüle
                </button>
            </div>
        </div>

        <!-- Guide Page -->
        <div id="guide" class="page hidden">
            <div class="max-w-3xl mx-auto fade-in">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">Kullanım Kılavuzu</h2>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Hesap Oluşturma ve Giriş</h3>
                    <ol class="list-decimal pl-5 space-y-3 text-gray-700">
                        <li>Sağ üst köşedeki "Kayıt Ol" butonuna tıklayın.</li>
                        <li>Ad, e-posta ve şifre bilgilerinizi girin.</li>
                        <li>Hesabınızı oluşturduktan sonra, e-posta ve şifrenizle giriş yapabilirsiniz.</li>
                        <li>Her hesap en fazla 4 adet liste oluşturabilir.</li>
                    </ol>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Liste Oluşturma</h3>
                    <ol class="list-decimal pl-5 space-y-3 text-gray-700">
                        <li>"Liste Oluştur" butonuna tıklayın.</li>
                        <li>Listenize bir isim verin.</li>
                        <li>Öğe ekleme formunda öğe adı, miktarı ve isterseniz bir resim ekleyin.</li>
                        <li>"Öğe Ekle" butonuna tıklayarak listeye ekleyin.</li>
                        <li>Tüm öğeleri ekledikten sonra "Kaydet ve QR Kod Oluştur" butonuna tıklayın.</li>
                    </ol>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">QR Kod Paylaşımı</h3>
                    <ol class="list-decimal pl-5 space-y-3 text-gray-700">
                        <li>Liste oluşturulduktan sonra otomatik olarak bir QR kod oluşturulacaktır.</li>
                        <li>"QR Kodu İndir" butonuna tıklayarak kodu kaydedebilirsiniz.</li>
                        <li>QR kodu başkalarıyla paylaşabilirsiniz.</li>
                        <li>QR kodu taratarak listeye erişebilir ve gerekirse düzenleyebilirsiniz.</li>
                    </ol>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md card-hover transition-all">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Liste Düzenleme</h3>
                    <ol class="list-decimal pl-5 space-y-3 text-gray-700">
                        <li>Listenizi görüntülerken "Listeyi Düzenle" butonuna tıklayın.</li>
                        <li>Liste adını veya öğeleri değiştirebilir, yeni öğeler ekleyebilir veya mevcut öğeleri silebilirsiniz.</li>
                        <li>Değişiklikleri tamamladıktan sonra "Değişiklikleri Kaydet" butonuna tıklayın.</li>
                        <li>Değişiklikler aynı QR kod üzerinden erişilebilir olacaktır.</li>
                    </ol>
                </div>
            </div>
        </div>

        <!-- Contact Page -->
        <div id="contact" class="page hidden">
            <div class="max-w-3xl mx-auto fade-in">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">İletişim</h2>
                
                <div class="bg-white p-6 rounded-xl shadow-md mb-8 card-hover transition-all">
                    <div class="flex items-start mb-6">
                        <div class="text-primary text-2xl mr-4">
                            <i class="fas fa-envelope"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-gray-800 mb-1">E-posta</h3>
                            <p class="text-gray-700">info@qrliste.com</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start mb-6">
                        <div class="text-primary text-2xl mr-4">
                            <i class="fas fa-phone"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-gray-800 mb-1">Telefon</h3>
                            <p class="text-gray-700">+90 555 123 4567</p>
                        </div>
                    </div>
                    
                    <div class="flex items-start">
                        <div class="text-primary text-2xl mr-4">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold text-gray-800 mb-1">Adres</h3>
                            <p class="text-gray-700">Teknoloji Caddesi, No:42<br>İstanbul / Türkiye</p>
                        </div>
                    </div>
                </div>
                
                <div class="bg-white p-6 rounded-xl shadow-md card-hover transition-all">
                    <h3 class="text-xl font-bold text-gray-800 mb-4">Bize Yazın</h3>
                    
                    <form id="contact-form">
                        <div class="grid md:grid-cols-2 gap-4 mb-4">
                            <div>
                                <label for="contact-name" class="block text-gray-700 mb-2">Ad Soyad</label>
                                <input type="text" id="contact-name" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" required>
                            </div>
                            <div>
                                <label for="contact-email" class="block text-gray-700 mb-2">E-posta</label>
                                <input type="email" id="contact-email" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" required>
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label for="contact-subject" class="block text-gray-700 mb-2">Konu</label>
                            <input type="text" id="contact-subject" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" required>
                        </div>
                        
                        <div class="mb-6">
                            <label for="contact-message" class="block text-gray-700 mb-2">Mesajınız</label>
                            <textarea id="contact-message" rows="5" class="w-full px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary transition-all" required></textarea>
                        </div>
                        
                        <button type="submit" class="bg-primary text-white px-6 py-3 rounded-lg shadow-lg hover-bg-primary transition-all button-hover">
                            <i class="fas fa-paper-plane mr-2"></i> Gönder
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-white py-10 mt-16">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-3 gap-8">
                <div>
                    <div class="flex items-center space-x-2 mb-4">
                        <i class="fas fa-qrcode text-2xl text-white"></i>
                        <h3 class="text-xl font-bold">QR Liste</h3>
                    </div>
                    <p class="text-gray-400">
                        İhtiyaçlarınızı organize etmenin en kolay yolu. Liste oluşturun, QR kod ile paylaşın, düzenleyin.
                    </p>
                </div>
                
                <div>
                    <h3 class="text-lg font-bold mb-4">Hızlı Bağlantılar</h3>
                    <ul class="space-y-2 text-gray-400">
                        <li><a href="#" class="hover:text-white transition-all" onclick="showPage('home')">Ana Sayfa</a></li>
                        <li><a href="#" class="hover:text-white transition-all" onclick="showPage('guide')">Kullanım Kılavuzu</a></li>
                        <li><a href="#" class="hover:text-white transition-all" onclick="showPage('contact')">İletişim</a></li>
                        <li><a href="#" class="hover:text-white transition-all auth-hide" onclick="showPage('login')">Giriş Yap</a></li>
                        <li><a href="#" class="hover:text-white transition-all auth-hide" onclick="showPage('register')">Kayıt Ol</a></li>
                    </ul>
                </div>
                
                <div>
                    <h3 class="text-lg font-bold mb-4">İletişim</h3>
                    <ul class="space-y-2 text-gray-400">
                        <li class="flex items-start">
                            <i class="fas fa-envelope mt-1 mr-2"></i>
                            <span>info@qrliste.com</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-phone mt-1 mr-2"></i>
                            <span>+90 555 123 4567</span>
                        </li>
                        <li class="flex items-start">
                            <i class="fas fa-map-marker-alt mt-1 mr-2"></i>
                            <span>Teknoloji Caddesi, No:42<br>İstanbul / Türkiye</span>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p>&copy; 2025 QR Liste. Tüm hakları saklıdır.</p>
            </div>
        </div>
    </footer>

    <!-- QR Modal -->
    <div id="qr-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-6 rounded-xl shadow-lg max-w-md w-full fade-in">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold text-gray-800">QR Kod</h3>
                <button id="close-qr-modal" class="text-gray-500 hover:text-gray-800 transition-all">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="modal-qrcode-container" class="flex justify-center mb-6"></div>
            <div class="text-center text-gray-700 mb-6">
                <p class="mb-2">Bu QR kodu tarayarak listeye erişebilirsiniz.</p>
                <p id="qr-list-id" class="font-mono bg-gray-100 p-2 rounded"></p>
            </div>
            <div class="flex space-x-2">
                <button id="modal-download-qr" class="flex-1 bg-primary text-white py-2 rounded-lg hover-bg-primary transition-all button-hover">
                    <i class="fas fa-download mr-2"></i> QR Kodu İndir
                </button>
                <button id="copy-list-id" class="flex-1 bg-gray-200 text-gray-800 py-2 rounded-lg hover:bg-gray-300 transition-all button-hover">
                    <i class="fas fa-copy mr-2"></i> ID Kopyala
                </button>
            </div>
        </div>
    </div>

    <!-- Alert Component -->
    <div id="alert" class="fixed bottom-4 right-4 max-w-xs bg-white rounded-lg shadow-lg overflow-hidden transform transition-all duration-300 translate-y-20 opacity-0">
        <div class="p-4">
            <div class="flex items-start">
                <div id="alert-icon" class="flex-shrink-0">
                    <i class="fas fa-check-circle text-green-500 text-xl"></i>
                </div>
                <div class="ml-3 w-0 flex-1">
                    <p id="alert-message" class="text-sm font-medium text-gray-800">
                        İşlem başarıyla tamamlandı.
                    </p>
                </div>
                <div class="ml-4 flex-shrink-0 flex">
                    <button id="close-alert" class="inline-flex text-gray-400 hover:text-gray-500 transition-all">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
        </div>
        <div id="alert-progress" class="h-1 bg-green-500"></div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDummyAPIKey1234567890",
            authDomain: "qr-liste-app.firebaseapp.com",
            projectId: "qr-liste-app",
            storageBucket: "qr-liste-app.appspot.com",
            messagingSenderId: "123456789012",
            appId: "1:123456789012:web:abcdef1234567890"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();
        
        // Global variables
        let currentUser = null;
        let currentListId = null;
        let currentListItems = [];
        let editingListId = null;
        let editingListItems = [];
        let publicListId = null;
        let publicListItems = [];
        let qrScanner = null;
        
        // DOM Elements
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const pages = document.querySelectorAll('.page');
        const loginForm = document.getElementById('login-form');
        const registerForm = document.getElementById('register-form');
        const addItemButton = document.getElementById('add-item');
        const saveListButton = document.getElementById('save-list');
        const editListButton = document.getElementById('edit-list');
        const updateListButton = document.getElementById('update-list');
        const qrModal = document.getElementById('qr-modal');
        const closeQrModalButton = document.getElementById('close-qr-modal');
        const modalDownloadQrButton = document.getElementById('modal-download-qr');
        const copyListIdButton = document.getElementById('copy-list-id');
        const downloadQrButton = document.getElementById('download-qr');
        const editPublicListButton = document.getElementById('edit-public-list');
        const updatePublicListButton = document.getElementById('update-public-list');
        const editPublicAddItemButton = document.getElementById('edit-public-add-item');
        const scanQrButton = document.getElementById('scan-qr-button');
        const viewListButton = document.getElementById('view-list-button');
        const contactForm = document.getElementById('contact-form');
        const alert = document.getElementById('alert');
        const alertIcon = document.getElementById('alert-icon');
        const alertMessage = document.getElementById('alert-message');
        const alertProgress = document.getElementById('alert-progress');
        const closeAlertButton = document.getElementById('close-alert');
        
        // Event Listeners
        document.addEventListener('DOMContentLoaded', initApp);
        mobileMenuButton.addEventListener('click', toggleMobileMenu);
        loginForm.addEventListener('submit', handleLogin);
        registerForm.addEventListener('submit', handleRegister);
        addItemButton.addEventListener('click', addItemToList);
        saveListButton.addEventListener('click', saveList);
        editListButton.addEventListener('click', editList);
        updateListButton.addEventListener('click', updateList);
        closeQrModalButton.addEventListener('click', closeQrModal);
        modalDownloadQrButton.addEventListener('click', downloadQrCode);
        copyListIdButton.addEventListener('click', copyListId);
        downloadQrButton.addEventListener('click', downloadQrCode);
        editPublicListButton.addEventListener('click', editPublicList);
        updatePublicListButton.addEventListener('click', updatePublicList);
        editPublicAddItemButton.addEventListener('click', addItemToPublicList);
        scanQrButton.addEventListener('click', initQrScanner);
        viewListButton.addEventListener('click', viewListById);
        document.getElementById('edit-add-item').addEventListener('click', addItemToEditList);
        contactForm.addEventListener('submit', handleContactForm);
        closeAlertButton.addEventListener('click', hideAlert);
        
        // Initialize Application
        function initApp() {
            // Check if user is logged in
            auth.onAuthStateChanged(user => {
                currentUser = user;
                updateAuthUI();
                
                if (user) {
                    loadUserLists();
                }
                
                // Check for list ID in URL
                const urlParams = new URLSearchParams(window.location.search);
                const listId = urlParams.get('list');
                
                if (listId) {
                    loadPublicList(listId);
                } else {
                    showPage('home');
                }
            });
        }
        
        // Toggle Mobile Menu
        function toggleMobileMenu() {
            mobileMenu.classList.toggle('hidden');
        }
        
        // Show Page
        function showPage(pageId) {
            pages.forEach(page => {
                page.classList.add('hidden');
            });
            
            const pageToShow = document.getElementById(pageId);
            pageToShow.classList.remove('hidden');
            pageToShow.classList.add('fade-in');
            
            if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
                mobileMenu.classList.add('hidden');
            }
            
            // Scroll to top
            window.scrollTo(0, 0);
            
            // Update URL without reloading
            const state = { page: pageId };
            const title = document.title;
            const url = pageId === 'home' ? window.location.pathname : `?page=${pageId}`;
            history.pushState(state, title, url);
        }
        
        // Update UI based on authentication state
        function updateAuthUI() {
            const authHideElements = document.querySelectorAll('.auth-hide');
            const authShowElements = document.querySelectorAll('.auth-show');
            
            if (currentUser) {
                authHideElements.forEach(el => el.classList.add('hidden'));
                authShowElements.forEach(el => el.classList.remove('hidden'));
            } else {
                authHideElements.forEach(el => el.classList.remove('hidden'));
                authShowElements.forEach(el => el.classList.add('hidden'));
            }
        }
        
        // Login Handler
        async function handleLogin(e) {
            e.preventDefault();
            
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const errorElement = document.getElementById('login-error');
            
            try {
                await auth.signInWithEmailAndPassword(email, password);
                showPage('dashboard');
                showAlert('Başarıyla giriş yapıldı', 'success');
            } catch (error) {
                errorElement.textContent = error.message;
                errorElement.classList.remove('hidden');
            }
        }
        
        // Register Handler
        async function handleRegister(e) {
            e.preventDefault();
            
            const name = document.getElementById('register-name').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            const errorElement = document.getElementById('register-error');
            
            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                
                // Update user profile
                await userCredential.user.updateProfile({
                    displayName: name
                });
                
                // Create user document
                await db.collection('users').doc(userCredential.user.uid).set({
                    name,
                    email,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                showPage('dashboard');
                showAlert('Hesabınız başarıyla oluşturuldu', 'success');
            } catch (error) {
                errorElement.textContent = error.message;
                errorElement.classList.remove('hidden');
            }
        }
        
        // Logout Handler
        async function logout() {
            try {
                await auth.signOut();
                showPage('home');
                showAlert('Başarıyla çıkış yapıldı', 'success');
            } catch (error) {
                console.error('Logout error:', error);
                showAlert('Çıkış yapılırken bir hata oluştu', 'error');
            }
        }
        
        // Load User Lists
        async function loadUserLists() {
            if (!currentUser) return;
            
            try {
                const userListsRef = db.collection('lists').where('userId', '==', currentUser.uid);
                const snapshot = await userListsRef.get();
                
                const userListsElement = document.getElementById('user-lists');
                const noListsMessage = document.getElementById('no-lists-message');
                const qrListCounter = document.getElementById('qr-list-counter');
                
                userListsElement.innerHTML = '';
                
                if (snapshot.empty) {
                    noListsMessage.classList.remove('hidden');
                    qrListCounter.textContent = 'Listeniz yok (0/4)';
                    return;
                }
                
                noListsMessage.classList.add('hidden');
                qrListCounter.textContent = `Toplam ${snapshot.size} listeniz var (${snapshot.size}/4)`;
                
                snapshot.forEach(doc => {
                    const list = doc.data();
                    const listId = doc.id;
                    
                    const listElement = document.createElement('div');
                    listElement.className = 'bg-white p-6 rounded-xl shadow-md card-hover transition-all';
                    listElement.innerHTML = `
                        <h3 class="text-xl font-bold text-gray-800 mb-2">${list.name}</h3>
                        <p class="text-gray-600 mb-4">${list.items ? list.items.length : 0} öğe</p>
                        <div class="flex space-x-2">
                            <button class="flex-1 bg-primary text-white px-4 py-2 rounded-lg hover-bg-primary transition-all button-hover view-list-btn" data-id="${listId}">
                                <i class="fas fa-eye mr-2"></i> Görüntüle
                            </button>
                            <button class="bg-red-500 text-white px-3 py-2 rounded-lg hover:bg-red-600 transition-all button-hover delete-list-btn" data-id="${listId}">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    `;
                    
                    userListsElement.appendChild(listElement);
                    
                    // Add event listeners
                    listElement.querySelector('.view-list-btn').addEventListener('click', () => viewList(listId));
                    listElement.querySelector('.delete-list-btn').addEventListener('click', () => deleteList(listId));
                });
            } catch (error) {
                console.error('Error loading lists:', error);
                showAlert('Listeler yüklenirken bir hata oluştu', 'error');
            }
        }
        
        // Add Item to List
        function addItemToList() {
            const nameInput = document.getElementById('item-name');
            const quantityInput = document.getElementById('item-quantity');
            const imageInput = document.getElementById('item-image');
            const itemList = document.getElementById('item-list');
            const emptyMessage = document.getElementById('empty-list-message');
            
            const name = nameInput.value.trim();
            const quantity = quantityInput.value.trim();
            
            if (!name) {
                showAlert('Lütfen öğe adını girin', 'error');
                return;
            }
            
            const file = imageInput.files[0];
            const itemId = Date.now().toString();
            
            const item = {
                id: itemId,
                name,
                quantity: quantity || '-',
                imageUrl: null
            };
            
            currentListItems.push(item);
            
            // Update UI
            emptyMessage.classList.add('hidden');
            
            const itemElement = document.createElement('div');
            itemElement.className = 'flex items-center border-b border-gray-200 py-3 item-hover transition-all';
            itemElement.setAttribute('data-id', itemId);
            itemElement.innerHTML = `
                <div class="flex-shrink-0 w-16 h-16 bg-gray-100 rounded-lg mr-4 flex items-center justify-center overflow-hidden img-placeholder">
                    <i class="fas fa-image text-gray-400 text-xl"></i>
                </div>
                <div class="flex-1">
                    <h4 class="font-medium text-gray-800">${name}</h4>
                    <p class="text-gray-600 text-sm">${quantity || '-'}</p>
                </div>
                <button class="text-red-500 hover:text-red-700 ml-4 delete-item transition-all" data-id="${itemId}">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            
            itemList.appendChild(itemElement);
            
            // Add event listener for delete button
            itemElement.querySelector('.delete-item').addEventListener('click', () => removeItemFromList(itemId));
            
            // If file is selected, show it
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = 'w-full h-full object-cover';
                    
                    const imgPlaceholder = itemElement.querySelector('.img-placeholder');
                    imgPlaceholder.innerHTML = '';
                    imgPlaceholder.appendChild(img);
                    
                    // Save the base64 data temporarily
                    item.imageData = e.target.result;
                };
                reader.readAsDataURL(file);
            }
            
            // Clear inputs
            nameInput.value = '';
            quantityInput.value = '';
            imageInput.value = '';
        }
        
        // Remove Item from List
        function removeItemFromList(itemId) {
            currentListItems = currentListItems.filter(item => item.id !== itemId);
            
            const itemElement = document.querySelector(`[data-id="${itemId}"]`);
            if (itemElement) {
                itemElement.remove();
            }
            
            const itemList = document.getElementById('item-list');
            const emptyMessage = document.getElementById('empty-list-message');
            
            if (currentListItems.length === 0) {
                emptyMessage.classList.remove('hidden');
            }
        }
        
        // Save List
        async function saveList() {
            if (!currentUser) {
                showAlert('Lütfen önce giriş yapın', 'error');
                showPage('login');
                return;
            }
            
            const listName = document.getElementById('list-name').value.trim();
            
            if (!listName) {
                showAlert('Lütfen liste adını girin', 'error');
                return;
            }
            
            if (currentListItems.length === 0) {
                showAlert('Lütfen listeye en az bir öğe ekleyin', 'error');
                return;
            }
            
            try {
                // Check if user has reached the limit
                const userListsRef = db.collection('lists').where('userId', '==', currentUser.uid);
                const snapshot = await userListsRef.get();
                
                if (snapshot.size >= 4) {
                    showAlert('Maksimum liste sayısına ulaştınız (4/4)', 'error');
                    return;
                }
                
                // Upload images and update items
                const updatedItems = [];
                
                for (const item of currentListItems) {
                    const updatedItem = { ...item };
                    delete updatedItem.imageData;
                    
                    if (item.imageData) {
                        const imageRef = storage.ref(`images/${currentUser.uid}/${Date.now()}`);
                        
                        // Convert base64 to blob
                        const response = await fetch(item.imageData);
                        const blob = await response.blob();
                        
                        // Upload image
                        const snapshot = await imageRef.put(blob);
                        const imageUrl = await snapshot.ref.getDownloadURL();
                        updatedItem.imageUrl = imageUrl;
                    }
                    
                    updatedItems.push(updatedItem);
                }
                
                // Save list to Firestore
                const listRef = await db.collection('lists').add({
                    name: listName,
                    items: updatedItems,
                    userId: currentUser.uid,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                // Clear form
                document.getElementById('list-name').value = '';
                document.getElementById('item-list').innerHTML = `
                    <div id="empty-list-message" class="text-center py-8 text-gray-500">
                        <i class="fas fa-clipboard text-4xl mb-3"></i>
                        <p>Henüz öğe eklemediniz.</p>
                    </div>
                `;
                currentListItems = [];
                
                // Show QR code
                showQrModal(listRef.id);
                
                // Reload user lists
                loadUserLists();
                
                showAlert('Liste başarıyla oluşturuldu', 'success');
            } catch (error) {
                console.error('Error saving list:', error);
                showAlert('Liste kaydedilirken bir hata oluştu', 'error');
            }
        }
        
        // View List
        async function viewList(listId) {
            try {
                const listRef = db.collection('lists').doc(listId);
                const doc = await listRef.get();
                
                if (!doc.exists) {
                    showAlert('Liste bulunamadı', 'error');
                    return;
                }
                
                const list = doc.data();
                currentListId = listId;
                
                // Update UI
                document.getElementById('view-list-name').textContent = list.name;
                const itemList = document.getElementById('view-item-list');
                itemList.innerHTML = '';
                
                if (list.items && list.items.length > 0) {
                    list.items.forEach(item => {
                        const itemElement = document.createElement('div');
                        itemElement.className = 'flex items-center border-b border-gray-200 py-3 item-hover transition-all';
                        itemElement.innerHTML = `
                            <div class="flex-shrink-0 w-16 h-16 bg-gray-100 rounded-lg mr-4 flex items-center justify-center overflow-hidden">
                                ${item.imageUrl ? 
                                    `<img src="${item.imageUrl}" class="w-full h-full object-cover">` : 
                                    `<i class="fas fa-image text-gray-400 text-xl"></i>`}
                            </div>
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-800">${item.name}</h4>
                                <p class="text-gray-600 text-sm">${item.quantity || '-'}</p>
                            </div>
                        `;
                        itemList.appendChild(itemElement);
                    });
                } else {
                    itemList.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-clipboard text-4xl mb-3"></i>
                            <p>Bu listede henüz öğe yok.</p>
                        </div>
                    `;
                }
                
                // Generate QR code
                const qrContainer = document.getElementById('qrcode-container');
                qrContainer.innerHTML = '';
                const qrCode = new QRCode(qrContainer, {
                    text: `${window.location.origin}${window.location.pathname}?list=${listId}`,
                    width: 200,
                    height: 200,
                    colorDark: "#4f46e5",
                    colorLight: "#ffffff",
                    correctLevel: QRCode.CorrectLevel.H
                });
                
                showPage('viewList');
            } catch (error) {
                console.error('Error viewing list:', error);
                showAlert('Liste yüklenirken bir hata oluştu', 'error');
            }
        }
        
        // Edit List
        async function editList() {
            try {
                const listRef = db.collection('lists').doc(currentListId);
                const doc = await listRef.get();
                
                if (!doc.exists) {
                    showAlert('Liste bulunamadı', 'error');
                    return;
                }
                
                const list = doc.data();
                editingListId = currentListId;
                editingListItems = [...list.items];
                
                // Update UI
                document.getElementById('edit-list-name').value = list.name;
                document.getElementById('edit-list-id').textContent = `Liste ID: ${currentListId}`;
                
                const itemList = document.getElementById('edit-item-list');
                itemList.innerHTML = '';
                
                if (list.items && list.items.length > 0) {
                    list.items.forEach(item => {
                        const itemElement = document.createElement('div');
                        itemElement.className = 'flex items-center border-b border-gray-200 py-3 item-hover transition-all';
                        itemElement.setAttribute('data-id', item.id);
                        itemElement.innerHTML = `
                            <div class="flex-shrink-0 w-16 h-16 bg-gray-100 rounded-lg mr-4 flex items-center justify-center overflow-hidden">
                                ${item.imageUrl ? 
                                    `<img src="${item.imageUrl}" class="w-full h-full object-cover">` : 
                                    `<i class="fas fa-image text-gray-400 text-xl"></i>`}
                            </div>
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-800">${item.name}</h4>
                                <p class="text-gray-600 text-sm">${item.quantity || '-'}</p>
                            </div>
                            <button class="text-red-500 hover:text-red-700 ml-4 delete-item transition-all" data-id="${item.id}">
                                <i class="fas fa-trash"></i>
                            </button>
                        `;
                        itemList.appendChild(itemElement);
                        
                        // Add event listener for delete button
                        itemElement.querySelector('.delete-item').addEventListener('click', () => removeItemFromEditList(item.id));
                    });
                } else {
                    itemList.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-clipboard text-4xl mb-3"></i>
                            <p>Bu listede henüz öğe yok.</p>
                        </div>
                    `;
                }
                
                showPage('editList');
            } catch (error) {
                console.error('Error editing list:', error);
                showAlert('Liste düzenlenirken bir hata oluştu', 'error');
            }
        }
        
        // Remove Item from Edit List
        function removeItemFromEditList(itemId) {
            editingListItems = editingListItems.filter(item => item.id !== itemId);
            
            const itemElement = document.querySelector(`[data-id="${itemId}"]`);
            if (itemElement) {
                itemElement.remove();
            }
            
            const itemList = document.getElementById('edit-item-list');
            
            if (editingListItems.length === 0) {
                itemList.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-clipboard text-4xl mb-3"></i>
                        <p>Bu listede henüz öğe yok.</p>
                    </div>
                `;
            }
        }
        
        // Add Item to Edit List
        function addItemToEditList() {
            const nameInput = document.getElementById('edit-item-name');
            const quantityInput = document.getElementById('edit-item-quantity');
            const imageInput = document.getElementById('edit-item-image');
            const itemList = document.getElementById('edit-item-list');
            
            const name = nameInput.value.trim();
            const quantity = quantityInput.value.trim();
            
            if (!name) {
                showAlert('Lütfen öğe adını girin', 'error');
                return;
            }
            
            const file = imageInput.files[0];
            const itemId = Date.now().toString();
            
            const item = {
                id: itemId,
                name,
                quantity: quantity || '-',
                imageUrl: null
            };
            
            editingListItems.push(item);
            
            // Update UI
            if (itemList.querySelector('.text-center')) {
                itemList.innerHTML = '';
            }
            
            const itemElement = document.createElement('div');
            itemElement.className = 'flex items-center border-b border-gray-200 py-3 item-hover transition-all';
            itemElement.setAttribute('data-id', itemId);
            itemElement.innerHTML = `
                <div class="flex-shrink-0 w-16 h-16 bg-gray-100 rounded-lg mr-4 flex items-center justify-center overflow-hidden img-placeholder">
                    <i class="fas fa-image text-gray-400 text-xl"></i>
                </div>
                <div class="flex-1">
                    <h4 class="font-medium text-gray-800">${name}</h4>
                    <p class="text-gray-600 text-sm">${quantity || '-'}</p>
                </div>
                <button class="text-red-500 hover:text-red-700 ml-4 delete-item transition-all" data-id="${itemId}">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            
            itemList.appendChild(itemElement);
            
            // Add event listener for delete button
            itemElement.querySelector('.delete-item').addEventListener('click', () => removeItemFromEditList(itemId));
            
            // If file is selected, show it
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = 'w-full h-full object-cover';
                    
                    const imgPlaceholder = itemElement.querySelector('.img-placeholder');
                    imgPlaceholder.innerHTML = '';
                    imgPlaceholder.appendChild(img);
                    
                    // Save the base64 data temporarily
                    const itemIndex = editingListItems.findIndex(i => i.id === itemId);
                    if (itemIndex !== -1) {
                        editingListItems[itemIndex].imageData = e.target.result;
                    }
                };
                reader.readAsDataURL(file);
            }
            
            // Clear inputs
            nameInput.value = '';
            quantityInput.value = '';
            imageInput.value = '';
        }
        
        // Update List
        async function updateList() {
            try {
                const listName = document.getElementById('edit-list-name').value.trim();
                
                if (!listName) {
                    showAlert('Lütfen liste adını girin', 'error');
                    return;
                }
                
                if (editingListItems.length === 0) {
                    showAlert('Lütfen listeye en az bir öğe ekleyin', 'error');
                    return;
                }
                
                // Upload images and update items
                const updatedItems = [];
                
                for (const item of editingListItems) {
                    const updatedItem = { ...item };
                    delete updatedItem.imageData;
                    
                    if (item.imageData && !item.imageUrl) {
                        const imageRef = storage.ref(`images/${currentUser.uid}/${Date.now()}`);
                        
                        // Convert base64 to blob
                        const response = await fetch(item.imageData);
                        const blob = await response.blob();
                        
                        // Upload image
                        const snapshot = await imageRef.put(blob);
                        const imageUrl = await snapshot.ref.getDownloadURL();
                        updatedItem.imageUrl = imageUrl;
                    }
                    
                    updatedItems.push(updatedItem);
                }
                
                // Update list in Firestore
                await db.collection('lists').doc(editingListId).update({
                    name: listName,
                    items: updatedItems,
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                // Reload the view
                await viewList(editingListId);
                
                showAlert('Liste başarıyla güncellendi', 'success');
            } catch (error) {
                console.error('Error updating list:', error);
                showAlert('Liste güncellenirken bir hata oluştu', 'error');
            }
        }
        
        // Cancel Edit
        function cancelEdit() {
            viewList(editingListId);
        }
        
        // Delete List
        async function deleteList(listId) {
            if (!confirm('Bu listeyi silmek istediğinize emin misiniz?')) {
                return;
            }
            
            try {
                await db.collection('lists').doc(listId).delete();
                loadUserLists();
                showAlert('Liste başarıyla silindi', 'success');
            } catch (error) {
                console.error('Error deleting list:', error);
                showAlert('Liste silinirken bir hata oluştu', 'error');
            }
        }
        
        // Load Public List
        async function loadPublicList(listId) {
            try {
                const listRef = db.collection('lists').doc(listId);
                const doc = await listRef.get();
                
                if (!doc.exists) {
                    showAlert('Liste bulunamadı', 'error');
                    showPage('home');
                    return;
                }
                
                const list = doc.data();
                publicListId = listId;
                publicListItems = [...list.items];
                
                // Update UI
                document.getElementById('public-list-name').textContent = list.name;
                document.getElementById('public-list-id').textContent = `Liste ID: ${listId}`;
                
                const itemList = document.getElementById('public-item-list');
                itemList.innerHTML = '';
                
                if (list.items && list.items.length > 0) {
                    list.items.forEach(item => {
                        const itemElement = document.createElement('div');
                        itemElement.className = 'flex items-center border-b border-gray-200 py-3 item-hover transition-all';
                        itemElement.innerHTML = `
                            <div class="flex-shrink-0 w-16 h-16 bg-gray-100 rounded-lg mr-4 flex items-center justify-center overflow-hidden">
                                ${item.imageUrl ? 
                                    `<img src="${item.imageUrl}" class="w-full h-full object-cover">` : 
                                    `<i class="fas fa-image text-gray-400 text-xl"></i>`}
                            </div>
                            <div class="flex-1">
                                <h4 class="font-medium text-gray-800">${item.name}</h4>
                                <p class="text-gray-600 text-sm">${item.quantity || '-'}</p>
                            </div>
                        `;
                        itemList.appendChild(itemElement);
                    });
                } else {
                    itemList.innerHTML = `
                        <div class="text-center py-8 text-gray-500">
                            <i class="fas fa-clipboard text-4xl mb-3"></i>
                            <p>Bu listede henüz öğe yok.</p>
                        </div>
                    `;
                }
                
                // Check if the current user is the owner of the list
                if (currentUser && currentUser.uid === list.userId) {
                    document.getElementById('edit-public-list').classList.remove('hidden');
                } else {
                    document.getElementById('edit-public-list').classList.add('hidden');
                }
                
                showPage('publicList');
            } catch (error) {
                console.error('Error loading public list:', error);
                showAlert('Liste yüklenirken bir hata oluştu', 'error');
                showPage('home');
            }
        }
        
        // Edit Public List
        function editPublicList() {
            editingListId = publicListId;
            editingListItems = [...publicListItems];
            
            // Update UI
            document.getElementById('edit-public-list-name').value = document.getElementById('public-list-name').textContent;
            document.getElementById('edit-public-list-id').textContent = `Liste ID: ${publicListId}`;
            
            const itemList = document.getElementById('edit-public-item-list');
            itemList.innerHTML = '';
            
            if (publicListItems && publicListItems.length > 0) {
                publicListItems.forEach(item => {
                    const itemElement = document.createElement('div');
                    itemElement.className = 'flex items-center border-b border-gray-200 py-3 item-hover transition-all';
                    itemElement.setAttribute('data-id', item.id);
                    itemElement.innerHTML = `
                        <div class="flex-shrink-0 w-16 h-16 bg-gray-100 rounded-lg mr-4 flex items-center justify-center overflow-hidden">
                            ${item.imageUrl ? 
                                `<img src="${item.imageUrl}" class="w-full h-full object-cover">` : 
                                `<i class="fas fa-image text-gray-400 text-xl"></i>`}
                        </div>
                        <div class="flex-1">
                            <h4 class="font-medium text-gray-800">${item.name}</h4>
                            <p class="text-gray-600 text-sm">${item.quantity || '-'}</p>
                        </div>
                        <button class="text-red-500 hover:text-red-700 ml-4 delete-item transition-all" data-id="${item.id}">
                            <i class="fas fa-trash"></i>
                        </button>
                    `;
                    itemList.appendChild(itemElement);
                    
                    // Add event listener for delete button
                    itemElement.querySelector('.delete-item').addEventListener('click', () => removeItemFromPublicEditList(item.id));
                });
            } else {
                itemList.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-clipboard text-4xl mb-3"></i>
                        <p>Bu listede henüz öğe yok.</p>
                    </div>
                `;
            }
            
            showPage('editPublicList');
        }
        
        // Remove Item from Public Edit List
        function removeItemFromPublicEditList(itemId) {
            editingListItems = editingListItems.filter(item => item.id !== itemId);
            
            const itemElement = document.querySelector(`[data-id="${itemId}"]`);
            if (itemElement) {
                itemElement.remove();
            }
            
            const itemList = document.getElementById('edit-public-item-list');
            
            if (editingListItems.length === 0) {
                itemList.innerHTML = `
                    <div class="text-center py-8 text-gray-500">
                        <i class="fas fa-clipboard text-4xl mb-3"></i>
                        <p>Bu listede henüz öğe yok.</p>
                    </div>
                `;
            }
        }
        
        // Add Item to Public List
        function addItemToPublicList() {
            const nameInput = document.getElementById('edit-public-item-name');
            const quantityInput = document.getElementById('edit-public-item-quantity');
            const imageInput = document.getElementById('edit-public-item-image');
            const itemList = document.getElementById('edit-public-item-list');
            
            const name = nameInput.value.trim();
            const quantity = quantityInput.value.trim();
            
            if (!name) {
                showAlert('Lütfen öğe adını girin', 'error');
                return;
            }
            
            const file = imageInput.files[0];
            const itemId = Date.now().toString();
            
            const item = {
                id: itemId,
                name,
                quantity: quantity || '-',
                imageUrl: null
            };
            
            editingListItems.push(item);
            
            // Update UI
            if (itemList.querySelector('.text-center')) {
                itemList.innerHTML = '';
            }
            
            const itemElement = document.createElement('div');
            itemElement.className = 'flex items-center border-b border-gray-200 py-3 item-hover transition-all';
            itemElement.setAttribute('data-id', itemId);
            itemElement.innerHTML = `
                <div class="flex-shrink-0 w-16 h-16 bg-gray-100 rounded-lg mr-4 flex items-center justify-center overflow-hidden img-placeholder">
                    <i class="fas fa-image text-gray-400 text-xl"></i>
                </div>
                <div class="flex-1">
                    <h4 class="font-medium text-gray-800">${name}</h4>
                    <p class="text-gray-600 text-sm">${quantity || '-'}</p>
                </div>
                <button class="text-red-500 hover:text-red-700 ml-4 delete-item transition-all" data-id="${itemId}">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            
            itemList.appendChild(itemElement);
            
            // Add event listener for delete button
            itemElement.querySelector('.delete-item').addEventListener('click', () => removeItemFromPublicEditList(itemId));
            
            // If file is selected, show it
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.className = 'w-full h-full object-cover';
                    
                    const imgPlaceholder = itemElement.querySelector('.img-placeholder');
                    imgPlaceholder.innerHTML = '';
                    imgPlaceholder.appendChild(img);
                    
                    // Save the base64 data temporarily
                    const itemIndex = editingListItems.findIndex(i => i.id === itemId);
                    if (itemIndex !== -1) {
                        editingListItems[itemIndex].imageData = e.target.result;
                    }
                };
                reader.readAsDataURL(file);
            }
            
            // Clear inputs
            nameInput.value = '';
            quantityInput.value = '';
            imageInput.value = '';
        }
        
        // Update Public List
        async function updatePublicList() {
            try {
                const listName = document.getElementById('edit-public-list-name').value.trim();
                
                if (!listName) {
                    showAlert('Lütfen liste adını girin', 'error');
                    return;
                }
                
                if (editingListItems.length === 0) {
                    showAlert('Lütfen listeye en az bir öğe ekleyin', 'error');
                    return;
                }
                
                // Upload images and update items
                const updatedItems = [];
                
                for (const item of editingListItems) {
                    const updatedItem = { ...item };
                    delete updatedItem.imageData;
                    
                    if (item.imageData && !item.imageUrl) {
                        const imageRef = storage.ref(`images/${currentUser.uid}/${Date.now()}`);
                        
                        // Convert base64 to blob
                        const response = await fetch(item.imageData);
                        const blob = await response.blob();
                        
                        // Upload image
                        const snapshot = await imageRef.put(blob);
                        const imageUrl = await snapshot.ref.getDownloadURL();
                        updatedItem.imageUrl = imageUrl;
                    }
                    
                    updatedItems.push(updatedItem);
                }
                
                // Update list in Firestore
                await db.collection('lists').doc(editingListId).update({
                    name: listName,
                    items: updatedItems,
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                // Reload the public view
                await loadPublicList(editingListId);
                
                showAlert('Liste başarıyla güncellendi', 'success');
            } catch (error) {
                console.error('Error updating public list:', error);
                showAlert('Liste güncellenirken bir hata oluştu', 'error');
            }
        }
        
        // Cancel Public Edit
        function cancelPublicEdit() {
            loadPublicList(editingListId);
        }
        
        // Show QR Modal
        function showQrModal(listId) {
            const modalQrContainer = document.getElementById('modal-qrcode-container');
            modalQrContainer.innerHTML = '';
            
            const listUrl = `${window.location.origin}${window.location.pathname}?list=${listId}`;
            const qrCode = new QRCode(modalQrContainer, {
                text: listUrl,
                width: 200,
                height: 200,
                colorDark: "#4f46e5",
                colorLight: "#ffffff",
                correctLevel: QRCode.CorrectLevel.H
            });
            
            document.getElementById('qr-list-id').textContent = listId;
            qrModal.classList.remove('hidden');
        }
        
        // Close QR Modal
        function closeQrModal() {
            qrModal.classList.add('hidden');
            document.getElementById('modal-qrcode-container').innerHTML = '';
        }
        
        // Download QR Code
        function downloadQrCode() {
            const canvas = document.querySelector('#modal-qrcode-container canvas') || 
                          document.querySelector('#qrcode-container canvas');
            
            if (!canvas) return;
            
            const link = document.createElement('a');
            link.download = 'qr-liste.png';
            link.href = canvas.toDataURL('image/png');
            link.click();
            
            showAlert('QR kodu indirildi', 'success');
        }
        
        // Copy List ID
        function copyListId() {
            const listId = document.getElementById('qr-list-id').textContent;
            navigator.clipboard.writeText(listId).then(() => {
                showAlert('Liste ID kopyalandı', 'success');
            }).catch(err => {
                console.error('Could not copy text: ', err);
                showAlert('Kopyalama başarısız', 'error');
            });
        }
        
        // Initialize QR Scanner
        function initQrScanner() {
            const qrScannerContainer = document.getElementById('qr-scanner-container');
            const videoElement = document.getElementById('qr-video');
            
            if (qrScannerContainer.classList.contains('hidden')) {
                qrScannerContainer.classList.remove('hidden');
                
                // Initialize scanner
                qrScanner = new QrScanner(
                    videoElement,
                    result => {
                        const listId = result.match(/list=([^&]+)/)?.[1];
                        if (listId) {
                            document.getElementById('list-id-input').value = listId;
                            qrScanner.stop();
                            qrScannerContainer.classList.add('hidden');
                        }
                    },
                    {
                        highlightScanRegion: true,
                        highlightCodeOutline: true,
                    }
                );
                
                qrScanner.start();
            } else {
                qrScanner.stop();
                qrScannerContainer.classList.add('hidden');
            }
        }
        
        // View List by ID
        function viewListById() {
            const listId = document.getElementById('list-id-input').value.trim();
            if (listId) {
                loadPublicList(listId);
            } else {
                showAlert('Lütfen bir liste ID girin', 'error');
            }
        }
        
        // Handle Contact Form
        function handleContactForm(e) {
            e.preventDefault();
            
            const name = document.getElementById('contact-name').value;
            const email = document.getElementById('contact-email').value;
            const subject = document.getElementById('contact-subject').value;
            const message = document.getElementById('contact-message').value;
            
            // Here you would typically send this data to your backend
            console.log('Contact form submitted:', { name, email, subject, message });
            
            // Clear form
            document.getElementById('contact-form').reset();
            
            showAlert('Mesajınız gönderildi. Teşekkür ederiz!', 'success');
        }
        
        // Show Alert
        function showAlert(message, type) {
            alertMessage.textContent = message;
            
            // Set icon and color based on type
            switch (type) {
                case 'success':
                    alertIcon.innerHTML = '<i class="fas fa-check-circle text-green-500 text-xl"></i>';
                    alertProgress.className = 'h-1 bg-green-500';
                    break;
                case 'error':
                    alertIcon.innerHTML = '<i class="fas fa-exclamation-circle text-red-500 text-xl"></i>';
                    alertProgress.className = 'h-1 bg-red-500';
                    break;
                case 'warning':
                    alertIcon.innerHTML = '<i class="fas fa-exclamation-triangle text-yellow-500 text-xl"></i>';
                    alertProgress.className = 'h-1 bg-yellow-500';
                    break;
                default:
                    alertIcon.innerHTML = '<i class="fas fa-info-circle text-blue-500 text-xl"></i>';
                    alertProgress.className = 'h-1 bg-blue-500';
            }
            
            // Show alert
            alert.classList.remove('translate-y-20', 'opacity-0');
            alert.classList.add('translate-y-0', 'opacity-100');
            
            // Progress bar animation
            alertProgress.style.width = '100%';
            alertProgress.style.transition = 'width 5s linear';
            setTimeout(() => {
                alertProgress.style.width = '0%';
            }, 50);
            
            // Auto hide after 5 seconds
            setTimeout(() => {
                hideAlert();
            }, 5000);
        }
        
        // Hide Alert
        function hideAlert() {
            alert.classList.add('translate-y-20', 'opacity-0');
            alert.classList.remove('translate-y-0', 'opacity-100');
        }
        
        // Handle back/forward browser buttons
        window.addEventListener('popstate', function(event) {
            const page = event.state?.page || 'home';
            showPage(page);
        });
    </script>
</body>
</html>
